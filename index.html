<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>演示：使用HTML5实现刮刮卡效果</title>
    <style type="text/css">
        *{
            margin:0;
            padding:0;
        }
        html,body{
            height: 100%;
        }

        .oprArea{
            height: 100%;
            position: relative;
            background: url("img/lucky-draw.png") left center no-repeat;
            background-size: contain;
        }
        .pumpkin{
            position: absolute;
            z-index: 5;
            left:100px;
            top:100px;
        }
        .light{
            position: absolute;
            z-index: 10;
            pointer-events: none;
            left: 50%;
            top: 50%;
        }
        #canvas{
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 100%;
            z-index: 8;
        }
    </style>
</head>

<body>
<div class="oprArea">
    <img class="light" src="img/share.png" alt="">
    <img class="pumpkin pumpkin1" src="img/star.png">
    <img class="pumpkin pumpkin2" src="img/star.png">
    <img class="pumpkin pumpkin3" src="img/star.png">
    <img class="pumpkin pumpkin4" src="img/star.png">
</div>
<canvas id="canvas"></canvas>

<script src="jquery.js"></script>
<script type="text/javascript">


    window.onload = function(e) {
        var $pumpkin = $('.pumpkin');
        var ctx;
        var canvas = document.querySelector('canvas');
        var w =  document.body.clientWidth,
                h =  document.body.clientHeight;
        var offsetX = canvas.offsetLeft,
                offsetY = canvas.offsetTop;
        canvas.width=w;
        canvas.height=h;
        ctx=canvas.getContext('2d');
        layer(ctx);
        canvas.addEventListener('touchstart', circle);
        $pumpkin.on('click',function(){
            alert(1)
        });
        function layer(ctx) {
            ctx.fillStyle='transparent';
            ctx.fillRect(0, 0,w,h);
            ctx.fillStyle = 'gray';
            ctx.fillRect(0, 0, w, h);
            ctx.globalCompositeOperation = 'destination-out';
        }
        function circle(e) {
            e.preventDefault();
            var $light = $('.light');
            var x = (e.targetTouches[0].clientX + document.body.scrollLeft || e.pageX) - offsetX || 0,
                    y = (e.targetTouches[0].clientY + document.body.scrollTop || e.pageY) - offsetY || 0;
            ctx.save();
            ctx.beginPath();
            ctx.arc(x, y, 20, 0, Math.PI * 2);
            ctx.fill();
            ctx.restore();
            $light.css({
                left: x +'px',
                top: y  +'px'
            })
        }
        function light(e) {
            e.preventDefault();

        }
    };

</script>
</body>
</html>